{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">{{ doc.title }}</h5>
    </div>
    <div class="card-body">
      <p><strong>Тип документа:</strong> {{ doc.type_choices|default:"—" }}</p>
      <p><strong>Статус:</strong> <span class="badge bg-secondary">{{ doc.get_status_display }}</span></p>
      <p><strong>Комментарий:</strong> {{ doc.reviewer_comment|default:"—" }}</p>
      <p><strong>Создатель:</strong> {{ doc.creator.get_full_name|default:doc.creator.username }}</p>
      <p><strong>Согласующий:</strong> {{ doc.executor.get_full_name|default:doc.executor.username }}</p>
      <p><strong>Дата создания:</strong> {{ doc.created_at|date:"d.m.Y H:i" }}</p>

      {% if doc.file %}
        <p><strong>Файл:</strong> <a href="{{ doc.file.url }}" class="btn btn-sm btn-outline-primary" target="_blank" download>Скачать</a></p>
      {% endif %}

    <hr>
    <h4>История маршрута документа</h4>
    {% if doc.action_logs.all %}
      <ul class="list-group">
        {% for log in doc.action_logs.all %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ log.user.get_full_name|default:log.user.username }}</strong>
              — {{ log.get_action_display }}
            </div>
            <small class="text-muted">{{ log.timestamp|date:"d.m.Y H:i" }}</small>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted">История действий отсутствует.</p>
    {% endif %}

    </div>
    <div class="card-footer text-end">
      <a href="{% url 'archive' %}" class="btn btn-outline-secondary">Назад</a>
    </div>
  </div>
</div>
{% endblock %}
